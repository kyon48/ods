# Copyright IBM Corp. All Rights Reserved.
#
# SPDX-License-Identifier: Apache-2.0
#

###############################################################################
#
#    Peer section
#
###############################################################################
peer:
  id: peer0.blockchain.islab.re.kr
  networkId: islab
  listenAddress: 0.0.0.0:9051
  chaincodeAddress: peer0.blockchain.islab.re.kr:9052
  chaincodeListenAddress: 0.0.0.0:9052
  address: peer0.blockchain.islab.re.kr:9051
  addressAutoDetect: true
  gomaxprocs: -1

  keepalive:
    minInterval: 60s
    client:
      interval: 60s
      timeout: 20s
    deliveryClient:
      interval: 60s
      timeout: 20s

  # Gossip related configuration
  gossip:
    bootstrap: peer0.blockchain.islab.re.kr:9051
    useLeaderElection: true
    orgLeader: false
    membershipTrackerInterval: 5s
    endpoint: peer0.blockchain.islab.re.kr:9051
    maxBlockCountToStore: 100
    maxPropagationBurstLatency: 10ms
    maxPropagationBurstSize: 10
    propagateIterations: 1
    propagatePeerNum: 3
    pullInterval: 4s
    pullPeerNum: 3
    requestStateInfoInterval: 4s
    publishStateInfoInterval: 4s
    stateInfoRetentionInterval:
    publishCertPeriod: 10s
    skipBlockVerification: false
    dialTimeout: 3s
    connTimeout: 2s
    recvBuffSize: 20
    sendBuffSize: 200
    digestWaitTime: 1s
    requestWaitTime: 1500ms
    responseWaitTime: 2s
    aliveTimeInterval: 5s
    aliveExpirationTimeout: 25s
    reconnectInterval: 25s
    externalEndpoint: peer0.blockchain.islab.re.kr:9051

    election:
      startupGracePeriod: 15s
      membershipSampleInterval: 1s
      leaderAliveThreshold: 10s
      leaderElectionDuration: 5s

    pvtData:
      pullRetryThreshold: 60s
      transientstoreMaxBlockRetention: 1000
      pushAckTimeout: 3s
      btlPullMargin: 10
      reconcileBatchSize: 10
      reconcileSleepInterval: 1m
      reconciliationEnabled: true

  # EventHub related configuration
  events:
    address: 0.0.0.0:7053
    buffersize: 100
    timeout: 10ms
    timewindow: 15m
    keepalive:
      minInterval: 60s
    sendTimeout: 10s

  # TLS Settings
  tls:
    enabled: true
    clientAuthRequired: false
    cert:
      file: crypto-config/peerOrganizations/blockchain.islab.re.kr/peers/peer0.blockchain.islab.re.kr/tls/server.crt
    key:
      file: crypto-config/peerOrganizations/blockchain.islab.re.kr/peers/peer0.blockchain.islab.re.kr/tls/server.key
    rootcert:
      file: crypto-config/peerOrganizations/blockchain.islab.re.kr/peers/peer0.blockchain.islab.re.kr/tls/ca.crt
    clientRootCAs:
      files:
        - crypto-config/peerOrganizations/blockchain.islab.re.kr/users/Admin@blockchain.islab.re.kr/tls/ca.crt

  # client messages
  authentication:
    timewindow: 15m

  fileSystemPath: /var/hyperledger/production/peer

  # BCCSP (Blockchain crypto provider): Select which crypto implementation or
  BCCSP:
    Default: SW
    SW:
      Hash: SHA2
      Security: 256
      FileKeyStore:
        KeyStore:

  # Path on the file system where peer will find MSP local configurations
  mspConfigPath: crypto-config/peerOrganizations/blockchain.islab.re.kr/peers/peer0.blockchain.islab.re.kr/msp

  # Identifier of the local MSP
  localMspId: blockchainMSP

  # Delivery blockchain related config
  deliveryclient:
    reconnectTotalTimeThreshold: 3600s
    connTimeout: 3s
    reConnectBackoffThreshold: 3600s

  # Type for the local MSP - by default it's of type bccsp
  localMspType: bccsp

  profile:
    enabled: false
    listenAddress: 0.0.0.0:6060

  adminblockchain:

  handlers:
    authFilters:
      - name: DefaultAuth
      - name: ExpirationCheck
    decorators:
      - name: DefaultDecorator
    endorsers:
      escc:
        name: DefaultEndorsement
        library:
    validators:
      vscc:
        name: DefaultValidation
        library:

  validatorPoolSize:

  discovery:
    enabled: true
    authCacheEnabled: true
    authCacheMaxSize: 1000
    authCachePurgeRetentionRatio: 0.75
    orgMembersAllowedAccess: false

###############################################################################
#
#    VM section
#
###############################################################################
vm:
  endpoint: unix:///var/run/docker.sock
  docker:
    tls:
      enabled: false
      ca:
        file: docker/ca.crt
      cert:
        file: docker/tls.crt
      key:
        file: docker/tls.key

    attachStdout: true

    hostConfig:
      NetworkMode: islab
      Dns:
        # - 172.30.1.220
      LogConfig:
        Type: json-file
        Config:
          max-size: "50m"
          max-file: "5"
      Memory: 2147483648

###############################################################################
#
#    Chaincode section
#
###############################################################################
chaincode:
  id:
    path:
    name:

  # Generic builder environment, suitable for most chaincode types
  builder: hyperledger/fabric-ccenv:amd64-2.2
  pull: false

  golang:
    runtime: hyperledger/fabric-baseos:amd64-2.2
    dynamicLink: false

  java:
    runtime: hyperledger/fabric-javaenv:amd64-2.2

  node:
    runtime: hyperledger/fabric-nodeenv:amd64-0.4.22

  installTimeout: 300s
  startupTimeout: 300s
  executeTimeout: 60s

  mode: net
  keepalive: 0

  system:
    _lifecycle: enable
    cscc: enable
    lscc: enable
    escc: enable
    vscc: enable
    qscc: enable

  systemPlugins:

  # Logging section for the chaincode container
  logging:
    level: debug
    shim: warning
    format: "%{color}%{time:2006-01-02 15:04:05.000 MST} [%{module}] %{shortfunc} -> %{level:.4s} %{id:03x}%{color:reset} %{message}"

###############################################################################
#
#    Ledger section - ledger configuration encompases both the blockchain
#    and the state
#
###############################################################################
ledger:
  blockchain:

  state:
    stateDatabase: CouchDB
    totalQueryLimit: 100000
    couchDBConfig:
      couchDBAddress: couchdb.peer0.blockchain.islab.re.kr:5984
      username: admin
      password: password
      maxRetries: 3
      maxRetriesOnStartup: 12
      requestTimeout: 35s
      internalQueryLimit: 1000
      maxBatchUpdateSize: 1000
      warmIndexesAfterNBlocks: 1
      createGlobalChangesDB: false

  history:
    enableHistoryDatabase: true

###############################################################################
#
#    Operations section
#
###############################################################################
operations:
  listenAddress: 127.0.0.1:9443
  tls:
    enabled: false
    cert:
      file:
    key:
      file:
    clientAuthRequired: false
    clientRootCAs:
      files: []

###############################################################################
#
#    Metrics section
#
###############################################################################
metrics:
  provider: disabled
  statsd:
    network: udp
    address: 0.0.0.0:8125
    writeInterval: 10s
    prefix:
